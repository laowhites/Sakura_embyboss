#（此处请注意，拉取的镜像仅适用于arm架构，amd请注意修改配置包括但不仅限于镜像等）
version: '3'
services:
  mysql:
    image: mysql:8.4.2-oraclelinux9
    #    image: mysql:8.4.2-oraclelinux9
    container_name: mysql # 容器名
    command: mysqld --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci # 设置utf8字符集
    restart: always
    networks:
      - navid_net
    environment:
      MYSQL_ROOT_PASSWORD: 123456 # root管理员用户密码
      MYSQL_USER: dog   # 创建需要连接的用户
      MYSQL_DATABASE: navid # 数据库名字
      MYSQL_PASSWORD: 1234  # 设置普通用户的密码
      MYSQL_ROOT_HOST: "%" # 所有ip可连接
      TZ: Asia/Shanghai
    ports:
      - '3306:3306'  # host物理直接映射端口为
  #    volumes:
  #      - /root/Navid/db:/var/lib/mysql

  # 以下 phpmyadmin 主要是为了更为直观的供owner翻阅数据，不影响bot运行，如有其他合适软件，可注释内容 # xxxx
  #  phpmyadmin:
  #    image: phpmyadmin/phpmyadmin
  #    container_name: phpmyadmin
  #    restart: always
  #    ports:
  #      - 8080:80  #映射端口可以自己改的
  #    environment:
  #      MYSQL_ROOT_PASSWORD: "123456"
  #      PMA_HOST: mysql
  #      PMA_PORT: 3306
  #    depends_on:
  #      - mysql

  navidBoss:
    image: baisansui/navidrome_bot:latest
    container_name: navid_bot
    restart: always
    environment:
      - HTTP_PROXY=http://localhost:8118
      - HTTPS_PROXY=https://localhost:8118
      - NO_PROXY=localhost,127.0.0.1,db,emby2.lilyya.xyz
      - SOCKS5_PROXY=socks5://localhost:8119
    networks:
      - navid_net
    volumes:
      - ./config.json:/app/config.json
      - ./log:/app/log
    depends_on:
      - mysql


networks:
  navid_net:
    driver: bridge